{
  "hash": "eab25b310d919b430b10b07fa95b0c7a",
  "result": {
    "markdown": "---\ntitle: Assignment 2\nauthor: Cody Appa\nformat: html\ncode-fold: true\ndate: 02/02/2023\n---\n\n# Summary\nUsing digital droplet PCR data we were able to quantify the ratio of the chromosomal origin and terminus of chlamydia on a population level. Using this data we can determine whether a population is actively in the cell cycle or not.\n\n::: {.cell execution_count=1}\n``` {.python .cell-code}\nimport matplotlib.pyplot as plt\nimport matplotlib.ticker as ticker\nimport numpy as np; np.random.seed(22)\nimport seaborn as sns; sns.set(color_codes=True)\nimport pandas as pd\n\nimport math\n```\n:::\n\n\n::: {.cell execution_count=2}\n``` {.python .cell-code}\ndatadir = '/Users/codyappa/Documents/BCB504/BCB504Portfolio/posts/post-with-code/Sheet 2-Table 1.csv'\n```\n:::\n\n\n::: {.cell execution_count=3}\n``` {.python .cell-code}\ndf = pd.read_csv('Sheet 2-Table 1.csv')\n```\n:::\n\n\n## My Data\nThe data used here is counts from around 20k individual pcr reactions per timepoint isolated in lipid droplets. We then use probes that are specific to individual chromosomal regions within the origin or terminus to determine the number of each. Actively replicating chromosomes start a replication fork at the origin leading to a 2:1 origin to terminus ratio. Non-replicating chromosomes only have one origin.\n\n::: {.cell execution_count=4}\n``` {.python .cell-code}\ndf\n```\n\n::: {.cell-output .cell-output-display execution_count=22}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Hpi</th>\n      <th>Treatment</th>\n      <th>PyrG raw</th>\n      <th>NqrA raw</th>\n      <th>Ratio</th>\n      <th>Dilution</th>\n      <th>pyrG copies/ul</th>\n      <th>nqrA copies/ul</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>18</td>\n      <td>Unt</td>\n      <td>76.9</td>\n      <td>140.0</td>\n      <td>1.820546</td>\n      <td>150</td>\n      <td>11535</td>\n      <td>21000</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>18</td>\n      <td>Unt</td>\n      <td>17.9</td>\n      <td>30.7</td>\n      <td>1.715084</td>\n      <td>600</td>\n      <td>10740</td>\n      <td>18420</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>18</td>\n      <td>Unt</td>\n      <td>77.6</td>\n      <td>141.0</td>\n      <td>1.817010</td>\n      <td>150</td>\n      <td>11640</td>\n      <td>21150</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>18</td>\n      <td>Unt</td>\n      <td>20.3</td>\n      <td>39.2</td>\n      <td>1.931034</td>\n      <td>600</td>\n      <td>12180</td>\n      <td>23520</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>18</td>\n      <td>Unt</td>\n      <td>91.9</td>\n      <td>166.0</td>\n      <td>1.806311</td>\n      <td>150</td>\n      <td>13785</td>\n      <td>24900</td>\n    </tr>\n    <tr>\n      <th>...</th>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n      <td>...</td>\n    </tr>\n    <tr>\n      <th>103</th>\n      <td>48</td>\n      <td>Wsh</td>\n      <td>67.2</td>\n      <td>71.9</td>\n      <td>1.069940</td>\n      <td>6400</td>\n      <td>430080</td>\n      <td>460160</td>\n    </tr>\n    <tr>\n      <th>104</th>\n      <td>48</td>\n      <td>Wsh</td>\n      <td>210.0</td>\n      <td>251.0</td>\n      <td>1.195238</td>\n      <td>1600</td>\n      <td>336000</td>\n      <td>401600</td>\n    </tr>\n    <tr>\n      <th>105</th>\n      <td>48</td>\n      <td>Wsh</td>\n      <td>50.8</td>\n      <td>61.8</td>\n      <td>1.216535</td>\n      <td>6400</td>\n      <td>325120</td>\n      <td>395520</td>\n    </tr>\n    <tr>\n      <th>106</th>\n      <td>48</td>\n      <td>Wsh</td>\n      <td>268.0</td>\n      <td>326.0</td>\n      <td>1.216418</td>\n      <td>1600</td>\n      <td>428800</td>\n      <td>521600</td>\n    </tr>\n    <tr>\n      <th>107</th>\n      <td>48</td>\n      <td>Wsh</td>\n      <td>59.1</td>\n      <td>70.1</td>\n      <td>1.186125</td>\n      <td>6400</td>\n      <td>378240</td>\n      <td>448640</td>\n    </tr>\n  </tbody>\n</table>\n<p>108 rows Ã— 8 columns</p>\n</div>\n```\n:::\n:::\n\n\n::: {.cell execution_count=5}\n``` {.python .cell-code}\ndf.describe()\n```\n\n::: {.cell-output .cell-output-display execution_count=23}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Hpi</th>\n      <th>PyrG raw</th>\n      <th>NqrA raw</th>\n      <th>Ratio</th>\n      <th>Dilution</th>\n      <th>pyrG copies/ul</th>\n      <th>nqrA copies/ul</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>count</th>\n      <td>108.000000</td>\n      <td>108.000000</td>\n      <td>108.000000</td>\n      <td>108.000000</td>\n      <td>108.000000</td>\n      <td>108.000000</td>\n      <td>1.080000e+02</td>\n    </tr>\n    <tr>\n      <th>mean</th>\n      <td>35.333333</td>\n      <td>225.462963</td>\n      <td>295.671296</td>\n      <td>1.344637</td>\n      <td>1729.166667</td>\n      <td>237534.120370</td>\n      <td>2.984672e+05</td>\n    </tr>\n    <tr>\n      <th>std</th>\n      <td>9.400736</td>\n      <td>199.513261</td>\n      <td>267.843689</td>\n      <td>0.221217</td>\n      <td>1721.227081</td>\n      <td>144646.196824</td>\n      <td>1.797389e+05</td>\n    </tr>\n    <tr>\n      <th>min</th>\n      <td>18.000000</td>\n      <td>17.900000</td>\n      <td>30.700000</td>\n      <td>1.069940</td>\n      <td>150.000000</td>\n      <td>10740.000000</td>\n      <td>1.842000e+04</td>\n    </tr>\n    <tr>\n      <th>25%</th>\n      <td>32.000000</td>\n      <td>83.825000</td>\n      <td>107.250000</td>\n      <td>1.200338</td>\n      <td>550.000000</td>\n      <td>165720.000000</td>\n      <td>2.074000e+05</td>\n    </tr>\n    <tr>\n      <th>50%</th>\n      <td>36.000000</td>\n      <td>146.500000</td>\n      <td>199.500000</td>\n      <td>1.242610</td>\n      <td>1200.000000</td>\n      <td>253560.000000</td>\n      <td>3.182400e+05</td>\n    </tr>\n    <tr>\n      <th>75%</th>\n      <td>42.000000</td>\n      <td>352.500000</td>\n      <td>435.250000</td>\n      <td>1.395836</td>\n      <td>2000.000000</td>\n      <td>308400.000000</td>\n      <td>4.013600e+05</td>\n    </tr>\n    <tr>\n      <th>max</th>\n      <td>48.000000</td>\n      <td>846.000000</td>\n      <td>1126.000000</td>\n      <td>1.961538</td>\n      <td>6400.000000</td>\n      <td>889600.000000</td>\n      <td>1.152000e+06</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n::: {.cell execution_count=6}\n``` {.python .cell-code}\nAttributes = pd.read_csv('Assignment2_description.csv')\n```\n:::\n\n\n::: {.cell execution_count=7}\n``` {.python .cell-code}\nAttributes\n```\n\n::: {.cell-output .cell-output-display execution_count=25}\n```{=html}\n<div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th></th>\n      <th>Attribute</th>\n      <th>Type</th>\n      <th>Description</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>0</th>\n      <td>Hpi</td>\n      <td>Categorical</td>\n      <td>Hours post infection</td>\n    </tr>\n    <tr>\n      <th>1</th>\n      <td>Treatment</td>\n      <td>Categorical</td>\n      <td>Whether sample was untreated, induced for Euo,...</td>\n    </tr>\n    <tr>\n      <th>2</th>\n      <td>PyrG raw</td>\n      <td>Quantitative</td>\n      <td>PyrG+ means the PCR was positive for the termi...</td>\n    </tr>\n    <tr>\n      <th>3</th>\n      <td>NqrA raw</td>\n      <td>Quantitative</td>\n      <td>NqrA+ means the PCR was positive for the origi...</td>\n    </tr>\n    <tr>\n      <th>4</th>\n      <td>Ratio</td>\n      <td>Quantitative</td>\n      <td>The ratio of Origins/Termini</td>\n    </tr>\n    <tr>\n      <th>5</th>\n      <td>Dilution</td>\n      <td>Categorical</td>\n      <td>Dilution of the wells prior to readout</td>\n    </tr>\n    <tr>\n      <th>6</th>\n      <td>PyrG copies/ul</td>\n      <td>Quantitative</td>\n      <td>PyrG numbers adjusted for dilution factor</td>\n    </tr>\n    <tr>\n      <th>7</th>\n      <td>NqrA copies/ul</td>\n      <td>Quantitative</td>\n      <td>Nqra numbers adjusted for dilution factor</td>\n    </tr>\n  </tbody>\n</table>\n</div>\n```\n:::\n:::\n\n\n## Plot\nIn order to properly visualize the ratios of three different treatments: Untreated, Induced, and Washout samples, I decided to use a violin plot. The violin plot allows for accurate visualization of ratios similar to a box and whisker plot, we then spaced out the individual treatments so that they would not overlap and cover eachother.\n\n::: {.cell execution_count=8}\n``` {.python .cell-code}\nwith plt.style.context('seaborn-white'):\n    fig, ax = plt.subplots(ncols=1)\n    sns.violinplot(x=df['Hpi'], y=df['Ratio'], hue=df['Treatment'], data=df, ax=ax, dodge =\"True\", boxprops=dict(alpha=1),linewidth=.9, scale=\"width\", showmeans=True)\nwith plt.style.context('classic'):\n    ax.legend(loc='upper right', fontsize=10)\n    ax.ticklabel_format( axis=\"y\", style=\"sci\", scilimits=(0,2))\nfig.set_size_inches(4, 4)\n#ax.set_yscale('symlog', linthreshy=200)\n```\n\n::: {.cell-output .cell-output-display}\n![](index_files/figure-html/cell-9-output-1.png){width=362 height=353}\n:::\n:::\n\n\n::: {.cell execution_count=9}\n``` {.python .cell-code}\nplt.show()\n```\n:::\n\n\n# Conclusions\nWe concluded from this plot that each treatment follows the same trend of starting off as dividing populations and then leaving the cell cycle after 32hpi. This indicates that the cells within the population are largely non replicators such as RBs or IBs.\n\n",
    "supporting": [
      "index_files"
    ],
    "filters": [],
    "includes": {
      "include-in-header": [
        "<script src=\"https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js\" integrity=\"sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==\" crossorigin=\"anonymous\"></script>\n<script src=\"https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js\" integrity=\"sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==\" crossorigin=\"anonymous\"></script>\n<script type=\"application/javascript\">define('jquery', [],function() {return window.jQuery;})</script>\n"
      ]
    }
  }
}