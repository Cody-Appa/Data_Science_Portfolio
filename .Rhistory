axis.title = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
plot.caption = element_text(hjust = .5, size = 8, margin = margin(t = 10, r = 10)))
girafe(code = print(gg))
library(sf)
library(ggplot2)
library(dplyr)
library(ggiraph)
data3 <- read.csv("Primary and Secondary Syphilis - Rates of Reported Cases by County United States 2021 .csv", header = TRUE)
data3$Rate <- as.numeric(gsub(",", "", data3$Rate), na.rm = TRUE)
invisible(suppressWarnings({
us_counties <- tigris::counties(cb = TRUE, resolution = "20m", year = 2020, class = "sf", progress = FALSE)
}))
us_counties_contiguous <- us_counties %>%
filter(
!(STATEFP %in% c("02", "15", "60", "66", "69", "72", "78"))
)
us_counties_data <- left_join(us_counties, data3, by = c("NAMELSAD" = "County", "STATE_NAME" = "State"))
us_counties_data$Rate <- as.numeric(us_counties_data$Rate)
us_counties_data_contiguous <- us_counties_data %>%
filter(
!(STATEFP %in% c("02", "15", "60", "66", "69", "72", "78"))
)
my_colors <- c('blue', 'red', 'orange', 'yellow')
gg <- ggplot() +
geom_sf_interactive(data = us_counties_data_contiguous, aes(fill = Rate, tooltip = paste(NAMELSAD, "<br>", STATE_NAME, "<br>", "Rate:", Rate)), color = "grey", size = 0.1) +
scale_fill_gradientn(colors = my_colors, na.value = "grey70", name = "Rate") +
labs(title = "Primary and Secondary Syphilis Infection Rate by County 2021", caption = "Figure 3: Total infection rate of primary and secondary Syphilis by county") +
theme_minimal() +
theme(axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
plot.caption = element_text(hjust = .5, size = 8, margin = margin(t = 10, r = 10)))
girafe(code = print(gg))
library(sf)
library(ggplot2)
library(dplyr)
library(ggiraph)
data2 <- read.csv("Gonorrhea - Rates of Reported Cases by County United States 2021 .csv", header = TRUE)
data2$Rate <- as.numeric(gsub(",", "", data2$Rate), na.rm = TRUE)
invisible(suppressWarnings({
us_counties <- tigris::counties(cb = TRUE, resolution = "20m", year = 2020, class = "sf", progress = FALSE)
}))
us_counties_contiguous <- us_counties %>%
filter(
!(STATEFP %in% c("02", "15", "60", "66", "69", "72", "78"))
)
us_counties_data <- left_join(us_counties, data2, by = c("NAMELSAD" = "County", "STATE_NAME" = "State"))
us_counties_data$Rate <- as.numeric(us_counties_data$Rate)
us_counties_data_contiguous <- us_counties_data %>%
filter(
!(STATEFP %in% c("02", "15", "60", "66", "69", "72", "78"))
)
my_colors <- c('blue', 'red', 'orange', 'yellow')
gg <- ggplot() +
geom_sf_interactive(data = us_counties_data_contiguous, aes(fill = Rate, tooltip = paste(NAMELSAD, "<br>", STATE_NAME, "<br>", "Rate:", Rate)), color = "grey", size = 0.1) +
scale_fill_gradientn(colors = my_colors, na.value = "grey70", name = "Rate") +
labs(title = "Gonorrhea Infection Rate by County 2021", caption = "Figure 2: Total infection rate of gonorrhea by county") +
theme_minimal() +
theme(axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
plot.caption = element_text(hjust = .5, size = 8, margin = margin(t = 10, r = 10)))
girafe(code = print(gg))
library(sf)
library(ggplot2)
library(dplyr)
library(ggiraph)
data <- read.csv("Chlamydia - Rates of Reported Cases by County United States 2021 .csv", header = TRUE)
data$Rate <- as.numeric(gsub(",", "", data$Rate))
invisible(suppressWarnings({
us_counties <- tigris::counties(cb = TRUE, resolution = "20m", year = 2020, class = "sf", progress = FALSE)
}))
us_counties_contiguous <- us_counties %>%
filter(
!(STATEFP %in% c("02", "15", "60", "66", "69", "72", "78"))
)
us_counties_data <- left_join(us_counties, data, by = c("NAMELSAD" = "County", "STATE_NAME" = "State"))
us_counties_data$Rate <- as.numeric(us_counties_data$Rate)
us_counties_data_contiguous <- us_counties_data %>%
filter(
!(STATEFP %in% c("02", "15", "60", "66", "69", "72", "78"))
)
my_colors <- c('blue', 'red', 'orange', 'yellow')
gg <- ggplot() +
geom_sf_interactive(data = us_counties_data_contiguous, aes(fill = Rate, tooltip = paste(NAMELSAD, "<br>", STATE_NAME, "<br>", "Rate:", Rate)), color = "grey", size = 0.1) +
scale_fill_gradientn(colors = my_colors, na.value = "grey70", name = "Rate") +
labs(title = "Chlamydia Infection Rate by County 2021", caption = "Figure 1: Total infection rate of chlamydia by county") +
theme_minimal() +
theme(axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
plot.caption = element_text(hjust = .5, size = 8, margin = margin(t = 10, r = 10)))
girafe(code = print(gg))
library(sf)
library(ggplot2)
library(dplyr)
library(ggiraph)
data3 <- read.csv("Primary and Secondary Syphilis - Rates of Reported Cases by County United States 2021 .csv", header = TRUE)
data3$Rate <- as.numeric(gsub(",", "", data3$Rate), na.rm = TRUE)
invisible(suppressWarnings({
us_counties <- tigris::counties(cb = TRUE, resolution = "20m", year = 2020, class = "sf", progress = FALSE)
}))
us_counties_contiguous <- us_counties %>%
filter(
!(STATEFP %in% c("02", "15", "60", "66", "69", "72", "78"))
)
us_counties_data <- left_join(us_counties, data3, by = c("NAMELSAD" = "County", "STATE_NAME" = "State"))
us_counties_data$Rate <- as.numeric(us_counties_data$Rate)
us_counties_data_contiguous <- us_counties_data %>%
filter(
!(STATEFP %in% c("02", "15", "60", "66", "69", "72", "78"))
)
my_colors <- c('blue', 'red', 'orange', 'yellow', 'white')
gg <- ggplot() +
geom_sf_interactive(data = us_counties_data_contiguous, aes(fill = Rate, tooltip = paste(NAMELSAD, "<br>", STATE_NAME, "<br>", "Rate:", Rate)), color = "grey", size = 0.1) +
scale_fill_gradientn(colors = my_colors, na.value = "grey70", name = "Rate") +
labs(title = "Primary and Secondary Syphilis Infection Rate by County 2021", caption = "Figure 3: Total infection rate of primary and secondary Syphilis by county") +
theme_minimal() +
theme(axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
plot.caption = element_text(hjust = .5, size = 8, margin = margin(t = 10, r = 10)))
girafe(code = print(gg))
library(sf)
library(ggplot2)
library(dplyr)
library(ggiraph)
data3 <- read.csv("Primary and Secondary Syphilis - Rates of Reported Cases by County United States 2021 .csv", header = TRUE)
data3$Rate <- as.numeric(gsub(",", "", data3$Rate), na.rm = TRUE)
invisible(suppressWarnings({
us_counties <- tigris::counties(cb = TRUE, resolution = "20m", year = 2020, class = "sf", progress = FALSE)
}))
us_counties_contiguous <- us_counties %>%
filter(
!(STATEFP %in% c("02", "15", "60", "66", "69", "72", "78"))
)
us_counties_data <- left_join(us_counties, data3, by = c("NAMELSAD" = "County", "STATE_NAME" = "State"))
us_counties_data$Rate <- as.numeric(us_counties_data$Rate)
us_counties_data_contiguous <- us_counties_data %>%
filter(
!(STATEFP %in% c("02", "15", "60", "66", "69", "72", "78"))
)
my_colors <- c('#140652', 'blue', 'red', 'orange', 'yellow', 'white')
gg <- ggplot() +
geom_sf_interactive(data = us_counties_data_contiguous, aes(fill = Rate, tooltip = paste(NAMELSAD, "<br>", STATE_NAME, "<br>", "Rate:", Rate)), color = "grey", size = 0.1) +
scale_fill_gradientn(colors = my_colors, na.value = "grey70", name = "Rate") +
labs(title = "Primary and Secondary Syphilis Infection Rate by County 2021", caption = "Figure 3: Total infection rate of primary and secondary Syphilis by county") +
theme_minimal() +
theme(axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
plot.caption = element_text(hjust = .5, size = 8, margin = margin(t = 10, r = 10)))
girafe(code = print(gg))
library(sf)
library(ggplot2)
library(dplyr)
library(ggiraph)
data3 <- read.csv("Primary and Secondary Syphilis - Rates of Reported Cases by County United States 2021 .csv", header = TRUE)
data3$Rate <- as.numeric(gsub(",", "", data3$Rate), na.rm = TRUE)
invisible(suppressWarnings({
us_counties <- tigris::counties(cb = TRUE, resolution = "20m", year = 2020, class = "sf", progress = FALSE)
}))
us_counties_contiguous <- us_counties %>%
filter(
!(STATEFP %in% c("02", "15", "60", "66", "69", "72", "78"))
)
us_counties_data <- left_join(us_counties, data3, by = c("NAMELSAD" = "County", "STATE_NAME" = "State"))
us_counties_data$Rate <- as.numeric(us_counties_data$Rate)
us_counties_data_contiguous <- us_counties_data %>%
filter(
!(STATEFP %in% c("02", "15", "60", "66", "69", "72", "78"))
)
my_colors <- c('blue', 'red', 'orange', 'yellow')
gg <- ggplot() +
geom_sf_interactive(data = us_counties_data_contiguous, aes(fill = Rate, tooltip = paste(NAMELSAD, "<br>", STATE_NAME, "<br>", "Rate:", Rate)), color = "grey", size = 0.1) +
scale_fill_gradientn(colors = my_colors, na.value = "grey70", name = "Rate") +
labs(title = "Primary and Secondary Syphilis Infection Rate by County 2021", caption = "Figure 3: Total infection rate of primary and secondary Syphilis by county") +
theme_minimal() +
theme(axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
plot.caption = element_text(hjust = .5, size = 8, margin = margin(t = 10, r = 10)))
girafe(code = print(gg))
# Set a limit for outliers
outlier_limit <- 900
# Create a new column to mark outliers
us_counties_data_contiguous <- us_counties_data_contiguous %>%
mutate(is_outlier = ifelse(Rate > outlier_limit, "Outlier", "Not Outlier"))
# Update the fill scale to show outliers in a different color
my_colors <- c('blue', 'red', 'orange', 'yellow', 'purple')
fill_scale <- scale_fill_manual(name = "Rate",
values = c("#7fcdbb", "#41b6c4", "#1d91c0", "#225ea8", "#253494"),
guide = guide_legend(override.aes = list(color = NA)))
fill_scale <- fill_scale %>%
new_scale("fill") %>%
set_labels(c("0-10", "10-20", "20-30", "30-50", ">50", "No Data")) %>%
set_limits(0, outlier_limit, include.lowest = TRUE, expand = c(0, 0.1))
library(sf)
library(ggplot2)
library(dplyr)
library(ggiraph)
data3 <- read.csv("Primary and Secondary Syphilis - Rates of Reported Cases by County United States 2021 .csv", header = TRUE)
data3$Rate <- as.numeric(gsub(",", "", data3$Rate), na.rm = TRUE)
invisible(suppressWarnings({
us_counties <- tigris::counties(cb = TRUE, resolution = "20m", year = 2020, class = "sf", progress = FALSE)
}))
us_counties_contiguous <- us_counties %>%
filter(
!(STATEFP %in% c("02", "15", "60", "66", "69", "72", "78"))
)
us_counties_data <- left_join(us_counties, data3, by = c("NAMELSAD" = "County", "STATE_NAME" = "State"))
us_counties_data$Rate <- as.numeric(us_counties_data$Rate)
us_counties_data_contiguous <- us_counties_data %>%
filter(
!(STATEFP %in% c("02", "15", "60", "66", "69", "72", "78"))
)
my_colors <- c('blue', 'red', 'orange', 'yellow')
gg <- ggplot() +
geom_sf_interactive(data = us_counties_data_contiguous, aes(fill = Rate, tooltip = paste(NAMELSAD, "<br>", STATE_NAME, "<br>", "Rate:", Rate)), color = "grey", size = 0.1) +
scale_fill_gradientn(colors = my_colors, na.value = "grey70", name = "Rate") +
labs(title = "Primary and Secondary Syphilis Infection Rate by County 2021", caption = "Figure 3: Total infection rate of primary and secondary Syphilis by county") +
theme_minimal() +
theme(axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
plot.caption = element_text(hjust = .5, size = 8, margin = margin(t = 10, r = 10)))
girafe(code = print(gg))
library(sf)
library(ggplot2)
library(dplyr)
library(ggiraph)
data3 <- read.csv("Primary and Secondary Syphilis - Rates of Reported Cases by County United States 2021 .csv", header = TRUE)
data3$Rate <- as.numeric(gsub(",", "", data3$Rate), na.rm = TRUE)
invisible(suppressWarnings({
us_counties <- tigris::counties(cb = TRUE, resolution = "20m", year = 2020, class = "sf", progress = FALSE)
}))
us_counties_contiguous <- us_counties %>%
filter(
!(STATEFP %in% c("02", "15", "60", "66", "69", "72", "78"))
)
us_counties_data <- left_join(us_counties, data3, by = c("NAMELSAD" = "County", "STATE_NAME" = "State"))
us_counties_data$Rate <- as.numeric(us_counties_data$Rate)
us_counties_data_contiguous <- us_counties_data %>%
filter(
!(STATEFP %in% c("02", "15", "60", "66", "69", "72", "78"))
)
my_colors <- c('blue', 'red', 'orange', 'yellow')
gg <- ggplot() +
geom_sf_interactive(data = us_counties_data_contiguous, aes(fill = Rate, tooltip = paste(NAMELSAD, "<br>", STATE_NAME, "<br>", "Rate:", Rate)), color = "grey", size = 0.1) +
scale_fill_gradientn(colors = my_colors, na.value = "grey70", name = "Rate") +
labs(title = "Primary and Secondary Syphilis Infection Rate by County 2021", caption = "Figure 3: Total infection rate of primary and secondary Syphilis by county") +
theme_minimal() +
theme(axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
plot.caption = element_text(hjust = .5, size = 8, margin = margin(t = 10, r = 10)))
girafe(code = print(gg))
library(sf)
library(ggplot2)
library(dplyr)
library(ggiraph)
data3 <- read.csv("Primary and Secondary Syphilis - Rates of Reported Cases by County United States 2021 .csv", header = TRUE)
data3$Rate <- as.numeric(gsub(",", "", data3$Rate), na.rm = TRUE)
invisible(suppressWarnings({
us_counties <- tigris::counties(cb = TRUE, resolution = "20m", year = 2020, class = "sf", progress = FALSE)
}))
us_counties_contiguous <- us_counties %>%
filter(
!(STATEFP %in% c("02", "15", "60", "66", "69", "72", "78"))
)
us_counties_data <- left_join(us_counties, data3, by = c("NAMELSAD" = "County", "STATE_NAME" = "State"))
us_counties_data$Rate <- as.numeric(us_counties_data$Rate)
us_counties_data_contiguous <- us_counties_data %>%
filter(
!(STATEFP %in% c("02", "15", "60", "66", "69", "72", "78"))
)
my_colors <- c('blue', 'red', 'orange', 'yellow')
gg <- ggplot() +
geom_sf_interactive(data = us_counties_data_contiguous, aes(fill = Rate, tooltip = paste(NAMELSAD, "<br>", STATE_NAME, "<br>", "Rate:", Rate)), color = "grey", size = 0.1) +
scale_fill_gradientn(colors = my_colors, na.value = "grey70", name = "Rate") +
labs(title = "Primary and Secondary Syphilis Infection Rate by County 2021", caption = "Figure 3: Total infection rate of primary and secondary Syphilis by county") +
theme_minimal() +
theme(axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
plot.caption = element_text(hjust = .5, size = 8, margin = margin(t = 10, r = 10)))
girafe(code = print(gg))
suppressPackageStartupMessages(library(tidyverse))
suppressPackageStartupMessages(library(scales))
suppressPackageStartupMessages(library(rnaturalearthdata))
suppressPackageStartupMessages(library(rnaturalearth))
suppressPackageStartupMessages(library(sf))
suppressPackageStartupMessages(library(tigris))
library(tidyverse)
library(dplyr)
library(ggplot2)
library(readxl)
library(scales)
library(rnaturalearth)
library(rnaturalearthdata)
library(sf)
library(tigris)
suppressPackageStartupMessages(library(tigris))
STIDictionary<-read_excel("STISheet.xlsx")
knitr::kable(STIDictionary)
data <- read.csv("Chlamydia - Rates of Reported Cases by County United States 2021 .csv")
library(sf)
library(ggplot2)
library(dplyr)
library(ggiraph)
data <- read.csv("Chlamydia - Rates of Reported Cases by County United States 2021 .csv", header = TRUE)
data$Rate <- as.numeric(gsub(",", "", data$Rate))
invisible(suppressWarnings({
us_counties <- tigris::counties(cb = TRUE, resolution = "20m", year = 2020, class = "sf", progress = FALSE)
}))
us_counties_contiguous <- us_counties %>%
filter(
!(STATEFP %in% c("02", "15", "60", "66", "69", "72", "78"))
)
us_counties_data <- left_join(us_counties, data, by = c("NAMELSAD" = "County", "STATE_NAME" = "State"))
us_counties_data$Rate <- as.numeric(us_counties_data$Rate)
us_counties_data_contiguous <- us_counties_data %>%
filter(
!(STATEFP %in% c("02", "15", "60", "66", "69", "72", "78"))
)
my_colors <- c('blue', 'red', 'orange', 'yellow')
gg <- ggplot() +
geom_sf_interactive(data = us_counties_data_contiguous, aes(fill = Rate, tooltip = paste(NAMELSAD, "<br>", STATE_NAME, "<br>", "Rate:", Rate)), color = "grey", size = 0.1) +
scale_fill_gradientn(colors = my_colors, na.value = "grey70", name = "Rate") +
labs(title = "Chlamydia Infection Rate by County 2021", caption = "Figure 1: Infection rate of chlamydia by county per 100k people") +
theme_minimal() +
theme(axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
plot.caption = element_text(hjust = .5, size = 8, margin = margin(t = 10, r = 10)))
girafe(code = print(gg))
View(data)
library(sf)
library(ggplot2)
library(dplyr)
library(ggiraph)
data <- read.csv("Chlamydia - Rates of Reported Cases by County United States 2021 .csv", header = TRUE)
data$Rate <- as.numeric(gsub(",", "", data$Rate))
invisible(suppressWarnings({
us_counties <- tigris::counties(cb = TRUE, resolution = "20m", year = 2020, class = "sf", progress = FALSE)
}))
us_counties_contiguous <- us_counties %>%
filter(
!(STATEFP %in% c("02", "15", "60", "66", "69", "72", "78"))
)
us_counties_data <- left_join(us_counties, data, by = c("NAMELSAD" = "County", "STATE_NAME" = "State"))
us_counties_data$Rate <- as.numeric(us_counties_data$Rate)
us_counties_data_contiguous <- us_counties_data %>%
filter(
!(STATEFP %in% c("02", "15", "60", "66", "69", "72", "78"))
)
my_colors <- c('blue', 'red', 'orange', 'yellow')
gg <- ggplot() +
geom_sf_interactive(data = us_counties_data_contiguous, aes(fill = Rate.Category, tooltip = paste(NAMELSAD, "<br>", STATE_NAME, "<br>", "Rate:", Rate)), color = "grey", size = 0.1) +
scale_fill_gradientn(colors = my_colors, na.value = "grey70", name = "Rate") +
labs(title = "Chlamydia Infection Rate by County 2021", caption = "Figure 1: Infection rate of chlamydia by county per 100k people") +
theme_minimal() +
theme(axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
plot.caption = element_text(hjust = .5, size = 8, margin = margin(t = 10, r = 10)))
girafe(code = print(gg))
library(sf)
library(ggplot2)
library(dplyr)
library(ggiraph)
data <- read.csv("Chlamydia - Rates of Reported Cases by County United States 2021 .csv", header = TRUE)
data$Rate <- as.numeric(gsub(",", "", data$Rate))
invisible(suppressWarnings({
us_counties <- tigris::counties(cb = TRUE, resolution = "20m", year = 2020, class = "sf", progress = FALSE)
}))
us_counties_contiguous <- us_counties %>%
filter(
!(STATEFP %in% c("02", "15", "60", "66", "69", "72", "78"))
)
us_counties_data <- left_join(us_counties, data, by = c("NAMELSAD" = "County", "STATE_NAME" = "State"))
us_counties_data$Rate <- as.numeric(us_counties_data$Rate)
us_counties_data_contiguous <- us_counties_data %>%
filter(
!(STATEFP %in% c("02", "15", "60", "66", "69", "72", "78"))
)
my_colors <- c('blue', 'red', 'orange', 'yellow')
gg <- ggplot() +
geom_sf_interactive(data = us_counties_data_contiguous, aes(fill = Rate, tooltip = paste(NAMELSAD, "<br>", STATE_NAME, "<br>", "Rate:", Rate)), color = "grey", size = 0.1) +
scale_fill_gradientn(colors = my_colors, na.value = "grey70", name = "Rate") +
labs(title = "Chlamydia Infection Rate by County 2021", caption = "Figure 1: Infection rate of chlamydia by county per 100k people") +
theme_minimal() +
theme(axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
plot.caption = element_text(hjust = .5, size = 8, margin = margin(t = 10, r = 10)))
girafe(code = print(gg))
library(sf)
library(ggplot2)
library(dplyr)
library(ggiraph)
data3 <- read.csv("Primary and Secondary Syphilis - Rates of Reported Cases by County United States 2021 .csv", header = TRUE)
data3$Rate <- as.numeric(gsub(",", "", data3$Rate), na.rm = TRUE)
invisible(suppressWarnings({
us_counties <- tigris::counties(cb = TRUE, resolution = "20m", year = 2020, class = "sf", progress = FALSE)
}))
us_counties_contiguous <- us_counties %>%
filter(
!(STATEFP %in% c("02", "15", "60", "66", "69", "72", "78"))
)
us_counties_data <- left_join(us_counties, data3, by = c("NAMELSAD" = "County", "STATE_NAME" = "State"))
us_counties_data$Rate <- as.numeric(us_counties_data$Rate)
us_counties_data_contiguous <- us_counties_data %>%
filter(
!(STATEFP %in% c("02", "15", "60", "66", "69", "72", "78"))
)
my_colors <- c('blue', 'red', 'orange', 'yellow')
gg <- ggplot() +
geom_sf_interactive(data = us_counties_data_contiguous, aes(fill = Rate, tooltip = paste(NAMELSAD, "<br>", STATE_NAME, "<br>", "Rate:", Rate)), color = "grey", size = 0.1) +
scale_fill_gradientn(colors = my_colors, na.value = "grey70", name = "Rate") +
labs(title = "Primary and Secondary Syphilis Infection Rate by County 2021", caption = "Figure 3: Infection rate of primary and secondary Syphilis by county per 100k people") +
theme_minimal() +
theme(axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
plot.caption = element_text(hjust = .5, size = 8, margin = margin(t = 10, r = 10)))
girafe(code = print(gg))
library(sf)
library(ggplot2)
library(dplyr)
library(ggiraph)
data3 <- read.csv("Primary and Secondary Syphilis - Rates of Reported Cases by County United States 2021 .csv", header = TRUE)
data3$Rate <- as.numeric(gsub(",", "", data3$Rate), na.rm = TRUE)
invisible(suppressWarnings({
us_counties <- tigris::counties(cb = TRUE, resolution = "20m", year = 2020, class = "sf", progress = FALSE)
}))
us_counties_contiguous <- us_counties %>%
filter(
!(STATEFP %in% c("02", "15", "60", "66", "69", "72", "78"))
)
us_counties_data <- left_join(us_counties, data3, by = c("NAMELSAD" = "County", "STATE_NAME" = "State"))
us_counties_data$Rate <- as.numeric(us_counties_data$Rate)
us_counties_data_contiguous <- us_counties_data %>%
filter(
!(STATEFP %in% c("02", "15", "60", "66", "69", "72", "78"))
)
my_colors <- c('blue', 'red', 'orange', 'yellow')
my_breaks <- c(0, 100, 200, 300, 400, 500, Inf)
my_labels <- c('0', '100', '200', '300', '400', '500+', 'Outlier')
gg <- ggplot() +
geom_sf_interactive(data = us_counties_data_contiguous,
aes(fill = cut(Rate, breaks = my_breaks, labels = my_labels),
tooltip = paste(NAMELSAD, "<br>", STATE_NAME, "<br>", "Rate:", Rate)),
color = "grey", size = 0.1) +
scale_fill_manual(values = c(my_colors, 'purple'), name = "Rate",
labels = c(my_labels[-length(my_labels)], '500+'),
guide = guide_legend(override.aes = list(size = 2))) +
labs(title = "Primary and Secondary Syphilis Infection Rate by County 2021",
caption = "Figure 3: Infection rate of primary and secondary Syphilis by county per 100k people") +
theme_minimal() +
theme(axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
plot.caption = element_text(hjust = .5, size = 8, margin = margin(t = 10, r = 10)))
girafe(code = print(gg))
library(sf)
library(ggplot2)
library(dplyr)
library(ggiraph)
data3 <- read.csv("Primary and Secondary Syphilis - Rates of Reported Cases by County United States 2021 .csv", header = TRUE)
data3$Rate <- as.numeric(gsub(",", "", data3$Rate), na.rm = TRUE)
invisible(suppressWarnings({
us_counties <- tigris::counties(cb = TRUE, resolution = "20m", year = 2020, class = "sf", progress = FALSE)
}))
us_counties_contiguous <- us_counties %>%
filter(
!(STATEFP %in% c("02", "15", "60", "66", "69", "72", "78"))
)
us_counties_data <- left_join(us_counties, data3, by = c("NAMELSAD" = "County", "STATE_NAME" = "State"))
us_counties_data$Rate <- as.numeric(us_counties_data$Rate)
us_counties_data_contiguous <- us_counties_data %>%
filter(
!(STATEFP %in% c("02", "15", "60", "66", "69", "72", "78"))
)
my_colors <- c('blue', 'red', 'orange', 'yellow')
gg <- ggplot() +
geom_sf_interactive(data = us_counties_data_contiguous, aes(fill = Rate, tooltip = paste(NAMELSAD, "<br>", STATE_NAME, "<br>", "Rate:", Rate)), color = "grey", size = 0.1) +
scale_fill_gradientn(colors = my_colors, na.value = "grey70", name = "Rate") +
labs(title = "Primary and Secondary Syphilis Infection Rate by County 2021", caption = "Figure 3: Infection rate of primary and secondary Syphilis by county per 100k people") +
theme_minimal() +
theme(axis.text = element_blank(),
axis.title = element_blank(),
axis.ticks = element_blank(),
panel.grid = element_blank(),
plot.caption = element_text(hjust = .5, size = 8, margin = margin(t = 10, r = 10)))
girafe(code = print(gg))
